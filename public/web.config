<?xml version="1.0" encoding="utf-8"?>

<configuration>
	<system.webServer>
		<staticContent>
			<remove fileExtension=".woff"/>
			<mimeMap fileExtension=".woff" mimeType="application/x-font-woff"/>
			<remove fileExtension=".woff2"/>
			<mimeMap fileExtension=".woff2" mimeType="application/x-font-woff2"/>
			<remove fileExtension=".ttf"/>
			<mimeMap fileExtension=".ttf" mimeType="application/octet-stream"/>
			<remove fileExtension=".svg"/>
			<mimeMap fileExtension=".svg" mimeType="image/svg+xml"/>
		</staticContent>

		<rewrite>
      <rules>
        <rule name="Add www" patternSyntax="Wildcard" stopProcessing="true">
          <match url="*" />
          <conditions>
            <add input="{HTTP_HOST}" pattern="garaji.me" />
          </conditions>
          <action type="Redirect" url="http://www.garaji.me/{R:1}" redirectType="Permanent" />
        </rule>
        <rule name="Add www" patternSyntax="Wildcard" stopProcessing="true">
          <match url="*" />
          <conditions>
            <add input="{HTTP_HOST}" pattern="garaji.com" />
          </conditions>
          <action type="Redirect" url="http://www.garaji.com/{R:1}" redirectType="Permanent" />
        </rule>
        <!--
        <rule name="HTTP to HTTPS redirect" stopProcessing="true">
          <match url="^(.*)$"/>
          <conditions logicalGrouping="MatchAll">
            <add input="{HTTPS}" pattern="^OFF$" ignoreCase="true" />
            <add input="{HTTP_HOST}" pattern="^localhost(:\d+)?$" ignoreCase="true" negate="true" />
            <add input="{HTTP_HOST}" pattern="^\d+.\d+.\d+.\d+(:\d+)?$" ignoreCase="true" negate="true" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" appendQueryString="true" redirectType="Permanent" />
        </rule>
        -->
      </rules>

      <outboundRules>
        <rule name="Add Strict-Transport-Security when HTTPS" enabled="true">
          <match serverVariable="RESPONSE_Strict_Transport_Security"
              pattern=".*" />
          <conditions>
            <add input="{HTTPS}" pattern="on" ignoreCase="true" />
          </conditions>
          <action type="Rewrite" value="max-age=31536000" />
        </rule>
      </outboundRules>
    </rewrite>
	</system.webServer>

</configuration>
